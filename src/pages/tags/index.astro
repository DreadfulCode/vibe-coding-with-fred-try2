---
import Layout from '../../layouts/Layout.astro';

// In a real implementation, we would fetch these from a CMS or content collection
const allPosts = [
  {
    title: "Getting Started with Modern React Patterns",
    slug: "getting-started-with-modern-react-patterns",
    pubDate: new Date('2025-04-10'),
    description: "Learn the latest React patterns and best practices for building scalable applications in 2025.",
    image: "https://images.pexels.com/photos/11035471/pexels-photo-11035471.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2",
    tags: ["react", "javascript", "frontend"],
    featured: true
  },
  {
    title: "Building a Full-Stack App with Astro and Supabase",
    slug: "building-fullstack-app-with-astro-supabase",
    pubDate: new Date('2025-04-01'),
    description: "A step-by-step guide to creating a full-stack application using Astro and Supabase.",
    image: "https://images.pexels.com/photos/4974914/pexels-photo-4974914.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2",
    tags: ["astro", "supabase", "fullstack"],
    featured: true
  },
  {
    title: "Advanced TypeScript Techniques for Better Code",
    slug: "advanced-typescript-techniques",
    pubDate: new Date('2025-03-28'),
    description: "Improve your TypeScript skills with these advanced techniques for writing safer, more maintainable code.",
    image: "https://images.pexels.com/photos/1181675/pexels-photo-1181675.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2",
    tags: ["typescript", "javascript", "dev-tools"],
    featured: false
  },
  {
    title: "CSS Grid Mastery: Building Complex Layouts",
    slug: "css-grid-mastery",
    pubDate: new Date('2025-03-22'),
    description: "Master CSS Grid to create complex, responsive layouts with less code and better maintainability.",
    image: "https://images.pexels.com/photos/196645/pexels-photo-196645.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2",
    tags: ["css", "frontend", "web-design"],
    featured: false
  },
  {
    title: "Performance Optimization Techniques for Modern Web Apps",
    slug: "performance-optimization-web-apps",
    pubDate: new Date('2025-03-15'),
    description: "Learn how to optimize your web applications for better performance and user experience.",
    image: "https://images.pexels.com/photos/3861969/pexels-photo-3861969.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2",
    tags: ["performance", "web-dev", "optimization"],
    featured: false
  },
  {
    title: "Introduction to WebAssembly for JavaScript Developers",
    slug: "webassembly-for-javascript-devs",
    pubDate: new Date('2025-03-10'),
    description: "Dive into WebAssembly and learn how to integrate it with your JavaScript projects for improved performance.",
    image: "https://images.pexels.com/photos/1092644/pexels-photo-1092644.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2",
    tags: ["webassembly", "javascript", "performance"],
    featured: false
  }
];

// Count posts by tag
const tagCounts = {};
allPosts.forEach((post) => {
  post.tags.forEach((tag) => {
    tagCounts[tag] = (tagCounts[tag] || 0) + 1;
  });
});

// Convert to array and sort by count (descending)
const tagList = Object.entries(tagCounts)
  .map(([name, count]) => ({ name, count }))
  .sort((a, b) => b.count - a.count);

// Group tags by first letter
const groupedTags = tagList.reduce((acc, tag) => {
  const firstLetter = tag.name.charAt(0).toUpperCase();
  if (!acc[firstLetter]) {
    acc[firstLetter] = [];
  }
  acc[firstLetter].push(tag);
  return acc;
}, {});

// Get sorted letters
const sortedLetters = Object.keys(groupedTags).sort();
---

<Layout title="Tags">
  <div class="bg-gradient-to-b from-primary-50 to-white py-12">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="max-w-3xl mx-auto text-center">
        <h1 class="text-3xl font-bold text-gray-900 mb-4">Browse Topics</h1>
        <p class="text-lg text-gray-600">
          Find articles by topic to discover content that interests you.
        </p>
      </div>
    </div>
  </div>
  
  <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <div class="max-w-4xl mx-auto">
      <!-- Popular tags -->
      <div class="mb-12">
        <h2 class="text-2xl font-bold text-gray-900 mb-6">Popular Topics</h2>
        <div class="flex flex-wrap gap-3">
          {tagList.slice(0, 10).map((tag) => (
            <a 
              href={`/tags/${tag.name}`} 
              class="inline-flex items-center px-4 py-2 rounded-full bg-primary-100 hover:bg-primary-200 text-primary-800 transition-colors"
            >
              <span>#{tag.name}</span>
              <span class="ml-2 px-2 py-0.5 text-xs rounded-full bg-primary-200 text-primary-800">
                {tag.count}
              </span>
            </a>
          ))}
        </div>
      </div>
      
      <!-- All tags by letter -->
      <div>
        <h2 class="text-2xl font-bold text-gray-900 mb-6">All Topics</h2>
        
        <!-- Alphabet navigation -->
        <div class="flex flex-wrap gap-2 mb-8">
          {sortedLetters.map((letter) => (
            <a 
              href={`#letter-${letter}`} 
              class="w-8 h-8 flex items-center justify-center rounded-full bg-gray-100 hover:bg-primary-100 text-gray-700 hover:text-primary-800 font-medium transition-colors"
            >
              {letter}
            </a>
          ))}
        </div>
        
        <!-- Tags by letter -->
        <div class="space-y-8">
          {sortedLetters.map((letter) => (
            <div id={`letter-${letter}`} class="scroll-mt-24">
              <h3 class="text-lg font-bold text-gray-900 mb-4 flex items-center">
                <span class="w-8 h-8 flex items-center justify-center rounded-full bg-primary-100 text-primary-800 mr-3">
                  {letter}
                </span>
                <span>Topics starting with {letter}</span>
              </h3>
              
              <div class="flex flex-wrap gap-3 ml-11">
                {groupedTags[letter].map((tag) => (
                  <a 
                    href={`/tags/${tag.name}`} 
                    class="inline-flex items-center px-3 py-1.5 rounded-full bg-gray-100 hover:bg-gray-200 text-gray-800 text-sm transition-colors"
                  >
                    <span>#{tag.name}</span>
                    <span class="ml-1.5 text-gray-500 text-xs">
                      ({tag.count})
                    </span>
                  </a>
                ))}
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>
  </div>
</Layout>